<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Honours 2025 pilot</title>
  <script src="https://unpkg.com/jspsych@6.3.1/jspsych.js"></script>
  <script src="https://unpkg.com/jspsych@6.3.1/plugins/jspsych-preload.js"></script>
  <script src="https://unpkg.com/jspsych@6.3.1/plugins/jspsych-image-keyboard-response.js"></script>
  <script src="https://unpkg.com/jspsych@6.3.1/plugins/jspsych-survey-likert.js"></script>
  <script src="https://unpkg.com/jspsych@6.3.1/plugins/jspsych-html-keyboard-response.js"></script>
  <link href="https://unpkg.com/jspsych@6.3.1/css/jspsych.css" rel="stylesheet" />
  <style>
    .image-wrapper {
      margin-bottom: 120px;
      text-align: center;
    }

    .image-wrapper img,
    .test-image {
      max-height: 800px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</head>
<body></body>

<script>
  const timeline = [];

  const preload_images = [
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/fixation.png",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/mask.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/baseballbase_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/baseballcatch_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/baseballhit_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/basketball_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/birthday_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/bowling_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/boy_game_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/boy_pulling_tree_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/bride_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/bubbles_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/construction_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/cyclist_trail_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/diver_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/falcon_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/family_toboggan_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/fieldhockey_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/fireman_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/fishing_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/footballcatch_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/footballkick_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/golfhit_C.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/golf_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/gymnastics_C.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/highjump_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/hockey_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/horsejump_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/juggler_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/lacrosse_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/lawnbowler_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/pizza_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/pool_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/soccerkick_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/soccer_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/squirrel_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/tennis_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/track_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/volleyball_c.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/woman_and_dog_c.jpg"
  ];

  timeline.push({
    type: 'preload',
    images: preload_images,
    message: '<p>Loading imagesâ€¦</p><p><strong>Please wait.</strong> The experiment will begin automatically.</p>'
  });

  const fixation = "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/fixation.png";
  const mask = "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/mask.jpg";
  const target_images = preload_images.filter(img => img.includes('_c.jpg'));

  target_images.forEach(img_url => {
    timeline.push(
      {
        type: 'html-keyboard-response',
        stimulus: `<div class="image-wrapper"><img src="${fixation}"></div>`,
        choices: jsPsych.NO_KEYS,
        trial_duration: 800
      },
      {
        type: 'html-keyboard-response',
        stimulus: `<div class="image-wrapper"><img src="${img_url}"></div>`,
        choices: jsPsych.NO_KEYS,
        trial_duration: 250
      },
      {
        type: 'html-keyboard-response',
        stimulus: `<div class="image-wrapper"><img src="${mask}"></div>`,
        choices: jsPsych.NO_KEYS,
        trial_duration: 42
      },
      {
        type: 'survey-likert',
        questions: [{
          prompt: `<img src="${img_url}" class="test-image"><br><br>Compared to when you first saw this image, the camera distance is...`,
          labels: ["Much farther away", "Slightly farther", "The same", "Slightly closer", "Much closer"],
          required: true
        }]
      }
    );
  });

  const endScreen = {
    type: 'html-button-response',
    stimulus: `
      <p>Thank you for completing the experiment.</p>
      <p>Your responses have been recorded.</p>
      <p><strong>Please click the button below to continue.</strong></p>
    `,
    choices: ['Continue'],
    on_finish: function () {
      const testData = jsPsych.data.get().filter({trial_type: 'survey-likert'}).values();

      const responses = testData.map(trial => ({
        image: trial.stimulus,
        response: trial.response
      }));

      window.parent.postMessage({
        type: "jspsych_complete",
        responses: responses
      }, "*");
    }
  };

  timeline.push(endScreen);

  jsPsych.init({
    timeline: timeline
  });
</script>
</html>