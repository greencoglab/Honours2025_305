<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Honours 2025 pilot</title>
  <script src="https://unpkg.com/jspsych@6.3.1/jspsych.js"></script>
  <script src="https://unpkg.com/jspsych@6.3.1/plugins/jspsych-preload.js"></script>
  <script src="https://unpkg.com/jspsych@6.3.1/plugins/jspsych-image-keyboard-response.js"></script>
  <script src="https://unpkg.com/jspsych@6.3.1/plugins/jspsych-survey-likert.js"></script>
  <script src="https://unpkg.com/jspsych@6.3.1/plugins/jspsych-html-keyboard-response.js"></script>
  <link href="https://unpkg.com/jspsych@6.3.1/css/jspsych.css" rel="stylesheet" />
  <style>
    .image-wrapper {
      margin-bottom: 120px;
      text-align: center;
    }

    .image-wrapper img,
    .test-image {
      max-height: 800px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</head>
<body></body>

<script>
  const timeline = [];

  const preload_images = [
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/fixation.png",
    "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/mask.jpg",
    "https://raw.githubusercontent.com/greencoglab/Honours2025_example-trial/main/img/Rollarcoaster%201.jpg"
  ];

  timeline.push({
    type: 'preload',
    images: preload_images,
    message: '<p>Loading imagesâ€¦</p><p><strong>Please wait.</strong> The experiment will begin automatically.</p>'
  });

  const fixation = "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/fixation.png";
  const mask = "https://raw.githubusercontent.com/greencoglab/Honours-2025/main/img/mask.jpg";
  const target_images = ["https://raw.githubusercontent.com/greencoglab/Honours2025_example-trial/main/img/Rollarcoaster%201.jpg"];

  target_images.forEach(img_url => {
    timeline.push(
      {
        type: 'html-keyboard-response',
        stimulus: `<div class="image-wrapper"><img src="${fixation}"></div>`,
        choices: jsPsych.NO_KEYS,
        trial_duration: 800
      },
      {
        type: 'html-keyboard-response',
        stimulus: `<div class="image-wrapper"><img src="${img_url}"></div>`,
        choices: jsPsych.NO_KEYS,
        trial_duration: 250
      },
      {
        type: 'html-keyboard-response',
        stimulus: `<div class="image-wrapper"><img src="${mask}"></div>`,
        choices: jsPsych.NO_KEYS,
        trial_duration: 42
      },
      {
        type: 'survey-likert',
        questions: [{
          prompt: `<img src="${img_url}" class="test-image"><br><br>Compared to when you first saw this image, the camera distance is...`,
          labels: ["Much farther away", "Slightly farther", "The same", "Slightly closer", "Much closer"],
          required: true
        }]
      }
    );
  });

  const endScreen = {
    type: 'html-keyboard-response',
    stimulus: `
      <p>Great work!</p>
      <p>That's exactly how the experiemnt will work. Ensure your have your browser set to full screen!</p>
      <p><strong>Press any key to continue.</strong></p>
    `,
    on_finish: function () {
      window.parent.postMessage({ type: "jspsych_finished" }, "*");
    }
  };

  timeline.push(endScreen);

  jsPsych.init({
    timeline: timeline
  });
</script>
</html>
